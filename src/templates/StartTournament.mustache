{{!*  Riichi mahjong stat GUI
*  Copyright (C) 2016  o.klimenko aka ctizen
*
*  This program is free software: you can redistribute it and/or modify
*  it under the terms of the GNU General Public License as published by
*  the Free Software Foundation, either version 3 of the License, or
*  (at your option) any later version.
*
*  This program is distributed in the hope that it will be useful,
*  but WITHOUT ANY WARRANTY; without even the implied warranty of
*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
*  GNU General Public License for more details.
*
*  You should have received a copy of the GNU General Public License
*  along with this program.  If not, see <http://www.gnu.org/licenses/>.
*}}
{{^allOk}}
  <h2>Нельзя стартовать игры: {{reason}}</h2>
{{/allOk}}
{{#allOk}}
  <h3>Старт игр с автоматической рассадкой</h3>
  <button onclick="location.href='/tourn/start/'" style="font-size: 50px; height: 100px">START AUTO</button>
  <hr />
  <h3>Старт игр с ручной рассадкой</h3>
    <form action="/tourn/startManual/" method="post">
        Введите состав столов. Один стол = одна строка.<br>
        Если не отмечена галочка, игроки будут рассажены на "восток-юг-запад-север" согласно порядку ввода.<br>
        Цифры означают текущее место игрока в рейтинге. Пример швейцарской рассадки с шагом 4 для четырех столов: <br>
        1-5-9-13<br>
        2-6-10-14<br>
        3-7-11-15<br>
        4-8-12-16<br>
        <div><textarea name="description" rows="6">{{tablesList}}</textarea></div>
        <div><label for="randomize" style="font-size: 17px;">
            <input checked="checked" id="randomize" type="checkbox" name="randomize" value="true"> Перемешать игроков за каждым столом
        </label></div>
        <div><input type="submit" style="font-size: 50px; height: 100px" value="START MANUAL"></div>
    </form>
{{/allOk}}
<hr />
<h3>Состояние столов:</h3>
<table class="table table-bordered">
  {{#tables}}
    <tr>#{{table_index}}</tr>
    <tr>
      {{#players}}
        <td>{{display_name}}</td>
      {{/players}}
      <td><span class="badge {{#finished}}badge-success{{/finished}}">{{status}}</span></td>
    </tr>
      <tr>
          <td colspan="5" style="font-weight: bold; font-size: 16px">
              Последний раунд:
              {{^last_round}}еще не состоялся{{/last_round}}
              {{#last_round}}
                  {{last_round}}
                  <a onclick="return window.confirm('Отменяем раунд: {{last_round}}. Точно отменить раунд? Назад дороги нет!')"
                     href="/tourn/dropLastRound/{{hash}}/"
                     style="background-color: #900; color: #fff; display: inline-block; padding: 5px; font-size: 16px"
                          >Отменить последний раунд</a>
              {{/last_round}}
          </td>
      </tr>
      <tr>
          <td style="font-weight: bold; font-size: 16px">
              Штрафы:
          </td>
          <td colspan="4">
              <ul>
              {{#penalties}}
                  <li>{{who}} - штраф {{amount}} очков. Причина: {{reason}}</li>
              {{/penalties}}
              </ul>
          </td>
      </tr>
  {{/tables}}
</table>

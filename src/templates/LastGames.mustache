{{!*  Riichi mahjong stat GUI
*  Copyright (C) 2016  o.klimenko aka ctizen
*
*  This program is free software: you can redistribute it and/or modify
*  it under the terms of the GNU General Public License as published by
*  the Free Software Foundation, either version 3 of the License, or
*  (at your option) any later version.
*
*  This program is distributed in the hope that it will be useful,
*  but WITHOUT ANY WARRANTY; without even the implied warranty of
*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
*  GNU General Public License for more details.
*
*  You should have received a copy of the GNU General Public License
*  along with this program.  If not, see <http://www.gnu.org/licenses/>.
*}}
<h2>Последние сыгранные игры</h2>
<br>
<div class="last-games">
    {{#noGames}}
        Ни одной игры еще не сыграно
    {{/noGames}}
    {{^noGames}}
        <table class='table table-striped table-condensed'>
            <tr>
                <th>#</th>
                <th>Время регистрации</th>
                <th>Игроки</th>
                <th>Всякое разное</th>
            </tr>
            {{#games}}
                <tr>
                    <td>{{index}}</td>
                    <td>{{playDate}}</td>
                    <td>
                        <table class='table table-condensed'>
                            {{#players}}
                                <tr class="user-item-row">
                                    <td>{{wind}} <b><a href="/graphs/?user={{id}}">{{display_name}}</a></b></td>
                                    <td>{{score}}</td>
                                    <td><span class='badge badge-{{label}}'>{{rating_delta}}</span></td>
                                </tr>
                            {{/players}}
                        </table>
                    </td>
                    <td>
                        <ul>
                            {{#replayLink}}
                                <li><a href='{{replayLink}}' target='_blank'>Посмотреть реплей</a></li>
                            {{/replayLink}}
                            <li>Лучшая рука: <b>{{bestHandPlayers}}</b> - {{bestHandCost}}</li>
                            <li>Выигрышей по рон: {{ronWins}}</li>
                            <li>Выигрышей по цумо: {{tsumoWins}}</li>
                            <li>Ничьих: {{draws}}</li>
                            {{#chombo}}
                                <li>Чомбо: {{chombo}}</li>
                            {{/chombo}}
                            {{#showPenalties}}
                                <li>
                                    Дополнительные штрафы:
                                    <ul>
                                        {{#penalties}}
                                            <li>{{who}} - {{amount}} очков ({{reason}})</li>
                                        {{/penalties}}
                                    </ul>
                                </li>
                            {{/showPenalties}}
                            <li>Полный лог игры:</li>
                            <div class='fullLog'>
                                {{#logItems}}
                                    <div>
                                        {{roundWind}}{{roundIndex}}:

                                        {{#roundTypeRon}}
                                            <b>{{winnerName}}</b> -
                                            {{yakuList}}{{#doras}}, дора {{doras}}{{/doras}} (<b>{{loserName}}</b>),
                                            {{#yakuman}}
                                                якуман!
                                            {{/yakuman}}
                                            {{^yakuman}}
                                                {{han}} хан{{#fu}}, {{fu}} фу{{/fu}}.
                                            {{/yakuman}}
                                            {{#riichiPlayers}}
                                                Риичи: {{riichiPlayers}}
                                            {{/riichiPlayers}}
                                        {{/roundTypeRon}}

                                        {{#roundTypeMultiRon}}
                                            Дабл-рон:
                                            {{#multiRonWins}}{{! double & triple rons }}
                                                <div>
                                                    <b>{{winnerName}}</b> -
                                                    {{yakuList}}{{#doras}}, дора {{doras}}{{/doras}} (<b>{{loserName}}</b>),
                                                    {{#yakuman}}
                                                        якуман!
                                                    {{/yakuman}}
                                                    {{^yakuman}}
                                                        {{han}} хан{{#fu}}, {{fu}} фу{{/fu}}.
                                                    {{/yakuman}}
                                                    {{#riichiPlayers}}
                                                        Риичи: {{riichiPlayers}}
                                                    {{/riichiPlayers}}
                                                </div>
                                            {{/multiRonWins}}
                                        {{/roundTypeMultiRon}}

                                        {{#roundTypeTsumo}}
                                            <b>{{winnerName}}</b> -
                                            {{yakuList}}{{#doras}}, дора {{doras}}{{/doras}} (цумо),
                                            {{#yakuman}}
                                                якуман!
                                            {{/yakuman}}
                                            {{^yakuman}}
                                                {{han}} хан{{#fu}}, {{fu}} фу{{/fu}}.
                                            {{/yakuman}}
                                            {{#riichiPlayers}}
                                                Риичи: {{riichiPlayers}}
                                            {{/riichiPlayers}}
                                        {{/roundTypeTsumo}}

                                        {{#roundTypeDraw}}
                                            Ничья (темпай: {{tempaiPlayers}}).
                                            {{#riichiPlayers}}
                                                Риичи: {{riichiPlayers}}
                                            {{/riichiPlayers}}
                                        {{/roundTypeDraw}}

                                        {{#roundTypeAbort}}
                                            Пересдача.
                                            {{#riichiPlayers}}
                                                Риичи: {{riichiPlayers}}
                                            {{/riichiPlayers}}
                                        {{/roundTypeAbort}}

                                        {{#roundTypeChombo}}
                                            Чомбо: {{loserName}}.
                                        {{/roundTypeChombo}}
                                    </div>
                                {{/logItems}}
                            </div>
                        </ul>
                    </td>
                </tr>
            {{/games}}
        </table>
        <div class='pagination'><ul>
            <li><a href='?page={{prevPage}}'>Назад</a></li>
            <li><a href='?page={{nextPage}}'>Вперед</a></li>
        </ul></div>
    {{/noGames}}
</div>